{% extends "base.html" %}
{% load widget_tweaks %}
{% load static %}

{% block title %} Subscription Master - Module Master {% endblock %}

{% block body %}

        <div class="main">
            <div class="inner-navbar">
                <div class="col-md-12">
                    <ul class="nav nav-tabs">
                        <li class="nav-item"><a class="nav-link active" href="Subscription_Master-Existing_Module_Master.html">Module Master</a></li>
                        <li class="nav-item"><a class="nav-link" href="Subscription_Master-Existing_Add-on_Services.html">Add-on Services</a></li>
                        <li class="nav-item"><a class="nav-link" href="Subscription_Master-Existing_Subscription_Plan.html">Subscription Plan</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-12">
                <div class="content-holder">
                        {% if messages %}
                            {% for message in messages %}
                                <div {% if message.tags %} class="alert {{ message.tags }} text-center"{% endif %}>
                                    {{ message }}
                                </div>
                            {% endfor %}
                        {% endif %}
                    <div class="row">
                        <div class="col-md-12 order-md-1">
                            <h5 class="title-holder">Create Coupon</h5>
                            <div class="btn-holder">
                                <a class="link-btn" href="{% url 'user_list' %}">Back to list</a>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                <form class="needs-validation" method="post" id="formSubmit" enctype="multipart/form-data">

                                        <div class="row">
                                            <div class="col-md-4 mb-3">
                                                <label for=""> Module <span class="red-color"> * </span></label>
                                                <input type="text" class="form-control" placeholder="code" name="code" id="code">
                                            </div>


                                            <p id="date_filter">
                                            <div class="col-md-4 mb-3">
                                                <div class="form-group ">
                                                    <span class="color">Start Date</span>
                                                    <div class="input-group">
                                                        <input type="text"  class="form-control border-right-0 border date_range_filter " id="datepicker_from" placeholder="dd/mm/yyyy">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 mb-3">
                                                <div class="form-group">
                                                    <span class="color">End Date</span>
                                                    <div class="input-group">
                                                        <input type="text"  class="form-control border-right-0 border date_range_filter " id="datepicker_to" placeholder="dd/mm/yyyy">
                                                    </div>
                                                </div>
                                            </div>

                                            </p>
                                             <div class="col-md-4 mb-3">
                                            <select class="form-control"  id="Profile_choices">
												    	<option value="is_individual" >Is Individual</option>
														<option value="is_hdc_individual" >Is hdc Individual</option>
                                                        <option value="is_hdc_hospital" >Is hdc Hospital</option>
														<option value="is_hdc_nursing_home" >Is hdc Nursing_home</option>
                                            </select>
                                             </div>

                                            <div class="col-md-12">
                                                <div class="mybtn-holder">
                                                    <button class="mybtn" data-toggle="collapse" data-target="#demo">Cancel</button>
                                                    <button class="mybtn" id="myBtnSave" type="submit">Add</button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    {% endblock %}
    {% block javascript %}

<script>

$(document).ready(function() {

    let formData = {
        code:"",
        startDate:"",
        endDate:"",
        profileChoice:""
    };

    $("#myBtnSave").click(function(e) {
        e.preventDefault();
		formData.code = $("#code").val();
		formData.startDate = $("#datepicker_from").datepicker({ dateFormat: 'dd,MM,yyyy' }).val();
		formData.endDate = $("#datepicker_to").datepicker({ dateFormat: 'dd,MM,yyyy' }).val();
		formData.profileChoice = $('#Profile_choices').find(":selected").val();
		console.log(formData);
    });

    $("#datepicker_from").datepicker({
        altFormat: "yy-mm-dd",
        "onSelect": function(date) {
            $("#datepicker_from").datepicker("option", "minDate", startDate);
        }
    });

    $("#datepicker_to").datepicker({
        altFormat: "yy-mm-dd",
        "onSelect": function(date) {
            $("#datepicker_to").datepicker("option", "minDate", startDate);
        }
    });

var myJSON = JSON.stringify(formData);
console.log(myJSON);

$('#formSubmit').on('submit', function(e){

e.preventDefault();



  $.ajax({
       type : "POST",
       url: "{% url 'Coupon_to_create' %}",
        data : myJSON,
       headers: { "X-CSRFToken": "{{ csrf_token }}" },

       success : function(response){


      			$("#formSubmit")[0].reset();
      		},
      		error : function(response){
      			console.log(response)
      		}

   });


        });



});
</script>
    {% endblock %}